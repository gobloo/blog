# Android Pentest Complete Cheat Sheet

## ğŸ› ï¸ **Setup & Prerequisites**

### Lab Environment
```


# Install ADB + Fastboot

sudo apt install android-tools-adb android-tools-fastboot

# Rooted Emulator / Device (recommended)

# Genymotion, Android Studio AVD, or physical rooted device

# Essential Tools

pip3 install frida frida-tools objection
sudo snap install jadx          \# Decompiler
sudo apt install apktool        \# APK decompiler
sudo snap install burpsuite     \# Proxy
docker run -it --rm -p 8000:8000 opensecurity/mobsf  \# MobSF

```

---

## ğŸ“‹ **Pentest Workflow**

```

1. RECON                    2. STATIC ANALYSIS     3. DYNAMIC ANALYSIS     4. EXPLOITATION
â”œâ”€â”€ Device recon            â”œâ”€â”€ APK decompile      â”œâ”€â”€ Network proxy       â”œâ”€â”€ Bypass protections
â”œâ”€â”€ App enumeration         â”œâ”€â”€ MobSF scan         â”œâ”€â”€ Frida/Objection     â”œâ”€â”€ Root/jailbreak bypass
â”œâ”€â”€ Permissions analysis    â”œâ”€â”€ Strings/secrets    â”œâ”€â”€ Runtime hooks       â””â”€â”€ RCE/shell
â””â”€â”€ Installed apps list     â””â”€â”€ Manifest review    â””â”€â”€ Log analysis        â””â”€â”€ Privilege escalation
```

---

## ğŸ” **RECON & ENUMERATION**

### ADB Commands
```bash
# Connect device
adb devices -l

# Shell access
adb shell

# List packages
adb shell pm list packages
adb shell pm list packages -3       # 3rd party only
adb shell pm list packages | grep target

# App info
adb shell dumpsys package com.target.app
adb shell pm path com.target.app    # Get APK path

# Pull APK
adb pull /data/app/com.target.app-*/base.apk app.apk

# Forward ports (Burp)
adb forward tcp:8080 tcp:8080

# Logcat
adb logcat | grep target
adb logcat *:S ReactNative:V ReactNativeJS:V  # React Native
```


### Frida Recon

```bash
frida-ls-devices
frida-ps -Uai                    # All apps
frida-ps -Ua                     # Running apps
```


---

## ğŸ“¦ **STATIC ANALYSIS**

### 1. **MobSF (Automated)**

```bash
# Docker (recommended)
docker run -it -p 8000:8000 opensecurity/mobsf
# Upload APK â†’ Get full report (permissions, strings, trackers, URLs, certs)

# Key sections to check:
# - Permissions
# - AndroidManifest.xml
# - Hardcoded secrets
# - Trackers
# - Malware Score
```


### 2. **APK Decompilation**

```bash
# Extract APK contents
unzip app.apk -d app_unzipped/

# Decompile with apktool (smali)
apktool d app.apk -o app_apktool/

# Decompile to Java (jadx - recommended)
jadx-gui app.apk
jadx app.apk -d app_jadx/        # CLI
```


### 3. **Key Files to Review**

```
AndroidManifest.xml     # Activities, permissions, exported components
res/values/strings.xml  # Hardcoded strings/secrets
classes.dex             # Decompiled bytecode (jadx)
lib/*/*.so              # Native libraries
assets/                 # Custom data
```


### 4. **Exported Components (Activities/Services)**

```bash
# List exported activities (low-hanging fruit)
adb shell dumpsys package com.target.app | grep -A20 "Activity"
# Launch manually:
adb shell am start -n com.target.app/.SecretActivity
```


---

## ğŸŒ **DYNAMIC ANALYSIS**

### 1. **Proxy Setup (Burp/Frida)**

```bash
# Configure device proxy (WiFi â†’ Manual â†’ Proxy â†’ 127.0.0.1:8080)
adb forward tcp:8080 tcp:8080     # Port forward
# Install Burp CA cert on device
```


### 2. **Frida Runtime Hooking**

```bash
# Attach to running app
frida -U -n com.target.app

# Spawn + hook
frida -U -f com.target.app -l bypass.js --no-pause

# Quick native tracing
frida-trace -U -i SSL_* -f com.target.app
```

**Common Frida Scripts** (save as `.js`):

```js
// SSL Pinning bypass (Android OkHttp)
Java.perform(function() {
    var CertificatePinner = Java.use('okhttp3.CertificatePinner');
    CertificatePinner.check.overload('java.lang.String', '[Ljava.security.cert.Certificate;').implementation = function() {
        console.log('[+] SSL Pinning bypassed');
    };
});
```


### 3. **Objection (Frida wrapper)**

```bash
objection -g com.target.app explore

# Common objection commands
android sslpinning disable
android root disable
android hooking watch class_method 'LoginActivity.login'
android keystore list
android clipboard monitor
memory dump all
```


---

## ğŸ›¡ï¸ **COMMON BYPASSES**

### Root Detection Bypass

```bash
# Objection
objection explore
android root disable

# Frida script
frida -U -f com.target.app -l universal_bypass.js --no-pause
```


### Emulator Detection Bypass

```bash
# Frida / Objection
android emulator bypass
```


### SSL Pinning Bypass

```
1. Objection: android sslpinning disable
2. Frida universal script (codeshare)
3. JustTrustMe (Xposed)
4. Burp + Frida
```


---

## ğŸ”“ **EXPLOITATION VECTORS**

### 1. **Content Providers (SQLi, path traversal)**

```bash
# Enumerate
adb shell dumpsys package com.target.app | grep "ContentProvider"

# Test generic queries
adb shell content query --uri content://com.target.app.provider/notes
```


### 2. **Deep Links / Intents**

```bash
# Fuzz intents
adb shell am start -a android.intent.action.VIEW -d "http://evil.com"
```


### 3. **Broadcast Receivers**

```bash
adb shell am broadcast -a com.target.SECRET_ACTION
```


### 4. **Exported Activities (Info leak)**

```bash
# List & launch
adb shell dumpsys package com.target.app | grep "Activity.*exported"
adb shell am start -n com.target.app/.DebugActivity
```


---

## ğŸ› ï¸ **TOOL SUMMARY**

| **Phase** | **Tool** | **Purpose** |
| :-- | :-- | :-- |
| Recon | `adb`, `frida-ps` | Device/app enumeration |
| Static | `MobSF`, `jadx` | APK analysis, decompilation |
| Dynamic | `Frida`, `Objection` | Runtime hooking, bypasses |
| Proxy | `Burp Suite` | Network traffic interception |
| Native | `Ghidra`, `IDA Pro` | .so library analysis |


---

## ğŸš€ **QUICK COMMANDS CHEAT SHEET**

```bash
# Pull APK
adb shell pm path com.target.app && adb pull <path>

# Install modified APK
adb install -r modded.apk

# Launch activity
adb shell am start -n com.target.app/.MainActivity

# Clear app data
adb shell pm clear com.target.app

# Frida attach
frida -U -n com.target.app

# Objection
objection -g com.target.app explore
android sslpinning disable
```

**Pro Tip**: Always start with **MobSF** for automated analysis, then **JADX** for deep static analysis, and **Frida/Objection** for dynamic bypasses and runtime inspection.[web:1][web:21][web:5]

